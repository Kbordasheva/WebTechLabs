@page "/apidemo"
@using System.Net.Http.Json;

@*@inject IHttpClientFactory clientFactory*@
@using WebApplication_Bordasheva.Blazor.Data;
@using WebApplication_Bordasheva.Blazor.Components;
@inject HttpClient client

<div class="container">
    <PhonesList @bind-Phones="phones" SelectedObjectChanged="ShowDetails"></PhonesList>
    <PhoneDetails @bind-Phone="SelectedPhone"></PhoneDetails>
</div>

@code {
    [Parameter]
    public IEnumerable<ListViewModel> phones { get; set; }


    string apiBaseAddress = "https://localhost:44382/Api/Phones";

    protected override async Task OnInitializedAsync()
    {
        phones = await client.GetFromJsonAsync<IEnumerable<ListViewModel>>(apiBaseAddress);
    }

    [Parameter] 
    public DetailsViewModel SelectedPhone { get; set; } 
    private async Task ShowDetails(int id) 
    { 
      SelectedPhone = await client.GetFromJsonAsync<DetailsViewModel>(apiBaseAddress+$"/{id}"); 
    } 
}
